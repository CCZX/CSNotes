<script>
  /*
    给定一个只包含 '(' 和 ')' 的字符串，找出最长的包含有效括号的子串的长度。
    示例 1:

    输入: "(()"
    输出: 2
    解释: 最长有效括号子串为 "()"
    示例 2:

    输入: ")()())"
    输出: 4
    解释: 最长有效括号子串为 "()()"
  */

  /**
   * @param {string} s
   * @return {number}
   */
  const longestValidParentheses1 = function (s) {
    const len = s.length
    let max = 0
    let left = 0
    let right = 0
    for (let i = 0; i < len; i++) {
      if (s[i] == '(') {
        left++
      } else {
        right++ // )
      }
      if (left === right) {
        // 如果左括号和右括号的数量相等就是有效括号
        max = Math.max(max, 2 * left)
      } else if (right > left) {
        // 右括号的数量大于右括号的数量则是无效括号
        left = right = 0
      }
    }
    left = right = 0
    for (let i = len - 1; i >= 0; i--) {
      if (s[i] == '(') {
        left++
      } else {
        right++
      }
      if (left == right) {
        max = Math.max(max, right * 2)
      } else if (left > right) {
        left = right = 0
      }
    }
    return max
  }
  console.log(longestValidParentheses1('()()'))
</script>